from utils.async_io import async_run
from core_module.transfer.baidu import BaiduTransferDriver, BaiduTransferTask

# 本案例展示 转存驱动
# 需要在async环境下实例化各类接口驱动
async def async_main():
    baidu_cookies = 'XFI=************************************; XFCS=****************************************************************; XFT=********************************************; BIDUPSID=********************************; PSTM=**********; BAIDUID=********************************:FG=1; PANWEB=1; secu=1; H_WISE_SIDS=**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************; H_WISE_SIDS_BFESS=**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************; BDUSS=X***********************************************************************************************************************************************************************************************; BDUSS_BFESS=************************************************************************************************************************************************************************************************; ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************'
    tasks = [BaiduTransferTask('https://pan.baidu.com/s/1VAvnfnXGpVwPl-P8izmtRA', code='b56w')]
    async with BaiduTransferDriver(baidu_cookies) as baidu_driver:
        coroutines = await baidu_driver.transfer(*tasks)
        for coro in coroutines:
            result: BaiduTransferTask = await coro
            print(f'任务 {str(result)} 转存到 {result.target_dir} 状态: {result.status_str}')


if __name__ == '__main__':
    async_run(async_main())